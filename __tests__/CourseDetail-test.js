import React from 'react'
import renderer from 'react-test-renderer'
import { configure, shallow } from 'enzyme'
import Adapter from 'enzyme-adapter-react-16/build'
import CourseDetail, { ClassItem } from '../src/components/CourseDetail'
import { createStore } from 'redux'
import { combinedReducer } from '../src/redux/reducers'

const course_info = JSON.parse('{"course_id":"SE101","course_name":"计算机系统基础（1）","course_hours":80,"course_credits":5.0,"general":false,"general_type":"","course_deptname":"电子信息与电气工程学院","classes":[{"classname":"2018-2019-1-SE101-392689","course_id":"SE101","teacher_id":"11145","teacher_name":"臧斌宇","teachers":"11145/臧斌宇/教授[电子信息与电气工程学院];10886/陈榕/副教授[电子信息与电气工程学院]","course_participants":48,"class_note":"","year":2018,"semester":1,"classSegments":[{"class_sec_id":9868,"classname":"2018-2019-1-SE101-392689","classroom":"东上院102","begin_week":null,"end_week":null,"begin_sec":null,"end_sec":null,"week":null,"odd_or_even":"b"},{"class_sec_id":9869,"classname":"2018-2019-1-SE101-392689","classroom":"东上院102","begin_week":null,"end_week":null,"begin_sec":null,"end_sec":null,"week":null,"odd_or_even":"b"},{"class_sec_id":9870,"classname":"2018-2019-1-SE101-392689","classroom":"东上院102","begin_week":null,"end_week":null,"begin_sec":null,"end_sec":null,"week":null,"odd_or_even":"b"},{"class_sec_id":9871,"classname":"2018-2019-1-SE101-392689","classroom":"东上院102","begin_week":null,"end_week":null,"begin_sec":null,"end_sec":null,"week":null,"odd_or_even":"b"},{"class_sec_id":20170,"classname":"2018-2019-1-SE101-392689","classroom":"东上院102","begin_week":1,"end_week":16,"begin_sec":7,"end_sec":8,"week":2,"odd_or_even":"b"},{"class_sec_id":20171,"classname":"2018-2019-1-SE101-392689","classroom":"东上院102","begin_week":1,"end_week":16,"begin_sec":7,"end_sec":8,"week":2,"odd_or_even":"b"},{"class_sec_id":20172,"classname":"2018-2019-1-SE101-392689","classroom":"东上院102","begin_week":1,"end_week":16,"begin_sec":3,"end_sec":4,"week":5,"odd_or_even":"b"},{"class_sec_id":20173,"classname":"2018-2019-1-SE101-392689","classroom":"东上院102","begin_week":1,"end_week":16,"begin_sec":3,"end_sec":4,"week":5,"odd_or_even":"b"}]}]}')
const course_info1 = JSON.parse('{"course_id":"SE102","course_name":"计算机系统基础（1）","course_hours":80,"course_credits":5.0,"general":false,"general_type":"","course_deptname":"电子信息与电气工程学院","classes":[{"classname":"2018-2019-1-SE101-392689","course_id":"SE101","teacher_id":"11145","teacher_name":"臧斌宇","teachers":"11145/臧斌宇/教授[电子信息与电气工程学院];10886/陈榕/副教授[电子信息与电气工程学院]","course_participants":48,"class_note":"","year":2018,"semester":1,"classSegments":[{"class_sec_id":9868,"classname":"2018-2019-1-SE101-392689","classroom":"东上院102","begin_week":null,"end_week":null,"begin_sec":null,"end_sec":null,"week":null,"odd_or_even":"b"},{"class_sec_id":9869,"classname":"2018-2019-1-SE101-392689","classroom":"东上院102","begin_week":null,"end_week":null,"begin_sec":null,"end_sec":null,"week":null,"odd_or_even":"b"},{"class_sec_id":9870,"classname":"2018-2019-1-SE101-392689","classroom":"东上院102","begin_week":null,"end_week":null,"begin_sec":null,"end_sec":null,"week":null,"odd_or_even":"b"},{"class_sec_id":9871,"classname":"2018-2019-1-SE101-392689","classroom":"东上院102","begin_week":null,"end_week":null,"begin_sec":null,"end_sec":null,"week":null,"odd_or_even":"b"},{"class_sec_id":20170,"classname":"2018-2019-1-SE101-392689","classroom":"东上院102","begin_week":1,"end_week":16,"begin_sec":7,"end_sec":8,"week":2,"odd_or_even":"b"},{"class_sec_id":20171,"classname":"2018-2019-1-SE101-392689","classroom":"东上院102","begin_week":1,"end_week":16,"begin_sec":7,"end_sec":8,"week":2,"odd_or_even":"b"},{"class_sec_id":20172,"classname":"2018-2019-1-SE101-392689","classroom":"东上院102","begin_week":1,"end_week":16,"begin_sec":3,"end_sec":4,"week":5,"odd_or_even":"b"},{"class_sec_id":20173,"classname":"2018-2019-1-SE101-392689","classroom":"东上院102","begin_week":1,"end_week":16,"begin_sec":3,"end_sec":4,"week":5,"odd_or_even":"b"}]}]}')
const course_info2= JSON.parse("{\"course_id\":\"SE232\",\"course_name\":\"程序设计与数据结构\",\"course_hours\":32,\"course_credits\":2.0,\"general\":false,\"general_type\":\"\",\"course_deptname\":\"电子信息与电气工程学院\",\"classes\":[{\"classname\":\"2018-2019-1-SE232-393020\",\"course_id\":\"SE232\",\"teacher_id\":\"09875\",\"teacher_name\":\"戚正伟\",\"teachers\":\"09875/戚正伟/教授[电子信息与电气工程学院];10620/李健/副教授[电子信息与电气工程学院]\",\"course_participants\":63,\"class_note\":\"本课程有大量课外上机要求，仅面向软件专业的工科平台学生\",\"year\":2018,\"semester\":1,\"classSegments\":[{\"class_sec_id\":30343,\"classname\":\"2018-2019-1-SE232-393020\",\"classroom\":\"中院312\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":3,\"end_sec\":4,\"week\":5,\"odd_or_even\":\"b\"},{\"class_sec_id\":30344,\"classname\":\"2018-2019-1-SE232-393020\",\"classroom\":\"中院312\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":3,\"end_sec\":4,\"week\":5,\"odd_or_even\":\"b\"}]}]}")
const course_info3= JSON.parse("{\"course_id\":\"MA080\",\"course_name\":\"高等数学（A）（1）\",\"course_hours\":96,\"course_credits\":6.0,\"general\":false,\"general_type\":\"\",\"course_deptname\":\"数学科学学院\",\"classes\":[{\"classname\":\"2018-2019-1-MA080-393329\",\"course_id\":\"MA080\",\"teacher_id\":\"03119\",\"teacher_name\":\"向光辉\",\"teachers\":\"03119/向光辉/副教授[数学科学学院]\",\"course_participants\":129,\"class_note\":\"仅限留学生\",\"year\":2018,\"semester\":1,\"classSegments\":[{\"class_sec_id\":31181,\"classname\":\"2018-2019-1-MA080-393329\",\"classroom\":\"东上院412\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":11,\"end_sec\":13,\"week\":2,\"odd_or_even\":\"b\"},{\"class_sec_id\":31182,\"classname\":\"2018-2019-1-MA080-393329\",\"classroom\":\"东上院412\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":11,\"end_sec\":13,\"week\":4,\"odd_or_even\":\"b\"}]},{\"classname\":\"2018-2019-1-MA080-393331\",\"course_id\":\"MA080\",\"teacher_id\":\"09743\",\"teacher_name\":\"余用江\",\"teachers\":\"09743/余用江/讲师(高校)[数学科学学院]\",\"course_participants\":29,\"class_note\":\"仅限内地班,预科班特招生\",\"year\":2018,\"semester\":1,\"classSegments\":[{\"class_sec_id\":31183,\"classname\":\"2018-2019-1-MA080-393331\",\"classroom\":\"东中院4-204\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":3,\"end_sec\":4,\"week\":1,\"odd_or_even\":\"b\"},{\"class_sec_id\":31184,\"classname\":\"2018-2019-1-MA080-393331\",\"classroom\":\"东中院4-202\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":1,\"end_sec\":2,\"week\":2,\"odd_or_even\":\"b\"},{\"class_sec_id\":31185,\"classname\":\"2018-2019-1-MA080-393331\",\"classroom\":\"东中院4-204\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":3,\"end_sec\":4,\"week\":5,\"odd_or_even\":\"b\"}]},{\"classname\":\"2018-2019-1-MA080-393463\",\"course_id\":\"MA080\",\"teacher_id\":\"09743\",\"teacher_name\":\"余用江\",\"teachers\":\"09743/余用江/讲师(高校)[数学科学学院]\",\"course_participants\":131,\"class_note\":\"\",\"year\":2018,\"semester\":1,\"classSegments\":[{\"class_sec_id\":31201,\"classname\":\"2018-2019-1-MA080-393463\",\"classroom\":\"东上院412\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":1,\"end_sec\":2,\"week\":1,\"odd_or_even\":\"b\"},{\"class_sec_id\":31202,\"classname\":\"2018-2019-1-MA080-393463\",\"classroom\":\"东上院412\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":3,\"end_sec\":4,\"week\":3,\"odd_or_even\":\"b\"},{\"class_sec_id\":31203,\"classname\":\"2018-2019-1-MA080-393463\",\"classroom\":\"东上院412\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":1,\"end_sec\":2,\"week\":5,\"odd_or_even\":\"b\"}]},{\"classname\":\"2018-2019-1-MA080-393464\",\"course_id\":\"MA080\",\"teacher_id\":\"05810\",\"teacher_name\":\"李为民\",\"teachers\":\"05810/李为民/教授[数学科学学院]\",\"course_participants\":54,\"class_note\":\"\",\"year\":2018,\"semester\":1,\"classSegments\":[{\"class_sec_id\":31204,\"classname\":\"2018-2019-1-MA080-393464\",\"classroom\":\"东下院115\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":3,\"end_sec\":4,\"week\":1,\"odd_or_even\":\"b\"},{\"class_sec_id\":31205,\"classname\":\"2018-2019-1-MA080-393464\",\"classroom\":\"东下院213\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":1,\"end_sec\":2,\"week\":3,\"odd_or_even\":\"b\"},{\"class_sec_id\":31206,\"classname\":\"2018-2019-1-MA080-393464\",\"classroom\":\"东下院115\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":3,\"end_sec\":4,\"week\":5,\"odd_or_even\":\"b\"}]},{\"classname\":\"2018-2019-1-MA080-393467\",\"course_id\":\"MA080\",\"teacher_id\":\"08137\",\"teacher_name\":\"于江\",\"teachers\":\"08137/于江/教授[数学科学学院]\",\"course_participants\":108,\"class_note\":\"\",\"year\":2018,\"semester\":1,\"classSegments\":[{\"class_sec_id\":31207,\"classname\":\"2018-2019-1-MA080-393467\",\"classroom\":\"东中院3-401\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":3,\"end_sec\":4,\"week\":1,\"odd_or_even\":\"b\"},{\"class_sec_id\":31208,\"classname\":\"2018-2019-1-MA080-393467\",\"classroom\":\"东中院3-401\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":3,\"end_sec\":4,\"week\":3,\"odd_or_even\":\"b\"},{\"class_sec_id\":31209,\"classname\":\"2018-2019-1-MA080-393467\",\"classroom\":\"东中院3-401\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":3,\"end_sec\":4,\"week\":5,\"odd_or_even\":\"b\"}]},{\"classname\":\"2018-2019-1-MA080-393468\",\"course_id\":\"MA080\",\"teacher_id\":\"11844\",\"teacher_name\":\"王晓东\",\"teachers\":\"11844/王晓东/副教授[数学科学学院]\",\"course_participants\":114,\"class_note\":\"\",\"year\":2018,\"semester\":1,\"classSegments\":[{\"class_sec_id\":31210,\"classname\":\"2018-2019-1-MA080-393468\",\"classroom\":\"东中院2-101\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":1,\"end_sec\":2,\"week\":1,\"odd_or_even\":\"b\"},{\"class_sec_id\":31211,\"classname\":\"2018-2019-1-MA080-393468\",\"classroom\":\"东中院2-101\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":3,\"end_sec\":4,\"week\":3,\"odd_or_even\":\"b\"},{\"class_sec_id\":31212,\"classname\":\"2018-2019-1-MA080-393468\",\"classroom\":\"东中院2-101\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":3,\"end_sec\":4,\"week\":5,\"odd_or_even\":\"b\"}]},{\"classname\":\"2018-2019-1-MA080-393469\",\"course_id\":\"MA080\",\"teacher_id\":\"10689\",\"teacher_name\":\"戎锋\",\"teachers\":\"10689/戎锋/教授[数学科学学院]\",\"course_participants\":113,\"class_note\":\"\",\"year\":2018,\"semester\":1,\"classSegments\":[{\"class_sec_id\":31213,\"classname\":\"2018-2019-1-MA080-393469\",\"classroom\":\"东中院3-201\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":1,\"end_sec\":2,\"week\":1,\"odd_or_even\":\"b\"},{\"class_sec_id\":31214,\"classname\":\"2018-2019-1-MA080-393469\",\"classroom\":\"东中院3-201\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":3,\"end_sec\":4,\"week\":3,\"odd_or_even\":\"b\"},{\"class_sec_id\":31215,\"classname\":\"2018-2019-1-MA080-393469\",\"classroom\":\"东中院3-201\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":3,\"end_sec\":4,\"week\":5,\"odd_or_even\":\"b\"}]},{\"classname\":\"2018-2019-1-MA080-393470\",\"course_id\":\"MA080\",\"teacher_id\":\"10784\",\"teacher_name\":\"顾琪龙\",\"teachers\":\"10784/顾琪龙/副教授[数学科学学院]\",\"course_participants\":112,\"class_note\":\"\",\"year\":2018,\"semester\":1,\"classSegments\":[{\"class_sec_id\":31216,\"classname\":\"2018-2019-1-MA080-393470\",\"classroom\":\"东中院3-301\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":1,\"end_sec\":2,\"week\":1,\"odd_or_even\":\"b\"},{\"class_sec_id\":31217,\"classname\":\"2018-2019-1-MA080-393470\",\"classroom\":\"东中院3-301\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":3,\"end_sec\":4,\"week\":3,\"odd_or_even\":\"b\"},{\"class_sec_id\":31218,\"classname\":\"2018-2019-1-MA080-393470\",\"classroom\":\"东中院3-301\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":3,\"end_sec\":4,\"week\":5,\"odd_or_even\":\"b\"}]},{\"classname\":\"2018-2019-1-MA080-393471\",\"course_id\":\"MA080\",\"teacher_id\":\"03135\",\"teacher_name\":\"王铭\",\"teachers\":\"03135/王铭/副教授[数学科学学院]\",\"course_participants\":123,\"class_note\":\"\",\"year\":2018,\"semester\":1,\"classSegments\":[{\"class_sec_id\":31175,\"classname\":\"2018-2019-1-MA080-393471\",\"classroom\":\"东中院2-401\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":1,\"end_sec\":2,\"week\":1,\"odd_or_even\":\"b\"},{\"class_sec_id\":31176,\"classname\":\"2018-2019-1-MA080-393471\",\"classroom\":\"东中院2-401\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":1,\"end_sec\":2,\"week\":3,\"odd_or_even\":\"b\"},{\"class_sec_id\":31177,\"classname\":\"2018-2019-1-MA080-393471\",\"classroom\":\"东中院2-401\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":3,\"end_sec\":4,\"week\":5,\"odd_or_even\":\"b\"}]},{\"classname\":\"2018-2019-1-MA080-393472\",\"course_id\":\"MA080\",\"teacher_id\":\"03134\",\"teacher_name\":\"何铭\",\"teachers\":\"03134/何铭/副教授[数学科学学院]\",\"course_participants\":129,\"class_note\":\"\",\"year\":2018,\"semester\":1,\"classSegments\":[{\"class_sec_id\":31178,\"classname\":\"2018-2019-1-MA080-393472\",\"classroom\":\"上院115\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":1,\"end_sec\":2,\"week\":1,\"odd_or_even\":\"b\"},{\"class_sec_id\":31179,\"classname\":\"2018-2019-1-MA080-393472\",\"classroom\":\"上院115\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":1,\"end_sec\":2,\"week\":3,\"odd_or_even\":\"b\"},{\"class_sec_id\":31180,\"classname\":\"2018-2019-1-MA080-393472\",\"classroom\":\"上院115\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":3,\"end_sec\":4,\"week\":5,\"odd_or_even\":\"b\"}]},{\"classname\":\"2018-2019-1-MA080-393473\",\"course_id\":\"MA080\",\"teacher_id\":\"08930\",\"teacher_name\":\"陈春丽\",\"teachers\":\"08930/陈春丽/副教授[数学科学学院]\",\"course_participants\":97,\"class_note\":\"\",\"year\":2018,\"semester\":1,\"classSegments\":[{\"class_sec_id\":31186,\"classname\":\"2018-2019-1-MA080-393473\",\"classroom\":\"东上院312\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":1,\"end_sec\":2,\"week\":1,\"odd_or_even\":\"b\"},{\"class_sec_id\":31187,\"classname\":\"2018-2019-1-MA080-393473\",\"classroom\":\"东上院312\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":1,\"end_sec\":2,\"week\":3,\"odd_or_even\":\"b\"},{\"class_sec_id\":31188,\"classname\":\"2018-2019-1-MA080-393473\",\"classroom\":\"东上院312\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":3,\"end_sec\":4,\"week\":5,\"odd_or_even\":\"b\"}]},{\"classname\":\"2018-2019-1-MA080-393474\",\"course_id\":\"MA080\",\"teacher_id\":\"07385\",\"teacher_name\":\"咸进国\",\"teachers\":\"07385/咸进国/副教授[数学科学学院]\",\"course_participants\":128,\"class_note\":\"\",\"year\":2018,\"semester\":1,\"classSegments\":[{\"class_sec_id\":31189,\"classname\":\"2018-2019-1-MA080-393474\",\"classroom\":\"东上院101\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":1,\"end_sec\":2,\"week\":1,\"odd_or_even\":\"b\"},{\"class_sec_id\":31190,\"classname\":\"2018-2019-1-MA080-393474\",\"classroom\":\"东上院101\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":1,\"end_sec\":2,\"week\":3,\"odd_or_even\":\"b\"},{\"class_sec_id\":31191,\"classname\":\"2018-2019-1-MA080-393474\",\"classroom\":\"东上院101\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":3,\"end_sec\":4,\"week\":5,\"odd_or_even\":\"b\"}]},{\"classname\":\"2018-2019-1-MA080-393476\",\"course_id\":\"MA080\",\"teacher_id\":\"03134\",\"teacher_name\":\"何铭\",\"teachers\":\"03134/何铭/副教授[数学科学学院]\",\"course_participants\":130,\"class_note\":\"\",\"year\":2018,\"semester\":1,\"classSegments\":[{\"class_sec_id\":31192,\"classname\":\"2018-2019-1-MA080-393476\",\"classroom\":\"上院115\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":3,\"end_sec\":4,\"week\":1,\"odd_or_even\":\"b\"},{\"class_sec_id\":31193,\"classname\":\"2018-2019-1-MA080-393476\",\"classroom\":\"上院115\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":3,\"end_sec\":4,\"week\":3,\"odd_or_even\":\"b\"},{\"class_sec_id\":31194,\"classname\":\"2018-2019-1-MA080-393476\",\"classroom\":\"上院115\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":1,\"end_sec\":2,\"week\":5,\"odd_or_even\":\"b\"}]},{\"classname\":\"2018-2019-1-MA080-393477\",\"course_id\":\"MA080\",\"teacher_id\":\"08930\",\"teacher_name\":\"陈春丽\",\"teachers\":\"08930/陈春丽/副教授[数学科学学院]\",\"course_participants\":114,\"class_note\":\"\",\"year\":2018,\"semester\":1,\"classSegments\":[{\"class_sec_id\":31195,\"classname\":\"2018-2019-1-MA080-393477\",\"classroom\":\"东上院311\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":3,\"end_sec\":4,\"week\":1,\"odd_or_even\":\"b\"},{\"class_sec_id\":31196,\"classname\":\"2018-2019-1-MA080-393477\",\"classroom\":\"东上院311\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":3,\"end_sec\":4,\"week\":3,\"odd_or_even\":\"b\"},{\"class_sec_id\":31197,\"classname\":\"2018-2019-1-MA080-393477\",\"classroom\":\"东上院311\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":1,\"end_sec\":2,\"week\":5,\"odd_or_even\":\"b\"}]},{\"classname\":\"2018-2019-1-MA080-393479\",\"course_id\":\"MA080\",\"teacher_id\":\"03107\",\"teacher_name\":\"李铮\",\"teachers\":\"03107/李铮/教授[数学科学学院]\",\"course_participants\":103,\"class_note\":\"\",\"year\":2018,\"semester\":1,\"classSegments\":[{\"class_sec_id\":31198,\"classname\":\"2018-2019-1-MA080-393479\",\"classroom\":\"东上院211\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":3,\"end_sec\":4,\"week\":1,\"odd_or_even\":\"b\"},{\"class_sec_id\":31199,\"classname\":\"2018-2019-1-MA080-393479\",\"classroom\":\"东上院211\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":3,\"end_sec\":4,\"week\":3,\"odd_or_even\":\"b\"},{\"class_sec_id\":31200,\"classname\":\"2018-2019-1-MA080-393479\",\"classroom\":\"东上院211\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":1,\"end_sec\":2,\"week\":5,\"odd_or_even\":\"b\"}]},{\"classname\":\"2018-2019-1-MA080-394398\",\"course_id\":\"MA080\",\"teacher_id\":\"10029\",\"teacher_name\":\"赵俐俐\",\"teachers\":\"10029/赵俐俐/副教授[数学科学学院]\",\"course_participants\":127,\"class_note\":\"\",\"year\":2018,\"semester\":1,\"classSegments\":[{\"class_sec_id\":31169,\"classname\":\"2018-2019-1-MA080-394398\",\"classroom\":\"东上院112\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":1,\"end_sec\":2,\"week\":1,\"odd_or_even\":\"b\"},{\"class_sec_id\":31170,\"classname\":\"2018-2019-1-MA080-394398\",\"classroom\":\"东上院112\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":3,\"end_sec\":4,\"week\":3,\"odd_or_even\":\"b\"},{\"class_sec_id\":31171,\"classname\":\"2018-2019-1-MA080-394398\",\"classroom\":\"东上院112\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":1,\"end_sec\":2,\"week\":5,\"odd_or_even\":\"b\"}]},{\"classname\":\"2018-2019-1-MA080-394400\",\"course_id\":\"MA080\",\"teacher_id\":\"10244\",\"teacher_name\":\"虞国富\",\"teachers\":\"10244/虞国富/教授[数学科学学院]\",\"course_participants\":119,\"class_note\":\"\",\"year\":2018,\"semester\":1,\"classSegments\":[{\"class_sec_id\":31172,\"classname\":\"2018-2019-1-MA080-394400\",\"classroom\":\"东上院202\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":1,\"end_sec\":2,\"week\":1,\"odd_or_even\":\"b\"},{\"class_sec_id\":31173,\"classname\":\"2018-2019-1-MA080-394400\",\"classroom\":\"东上院202\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":3,\"end_sec\":4,\"week\":3,\"odd_or_even\":\"b\"},{\"class_sec_id\":31174,\"classname\":\"2018-2019-1-MA080-394400\",\"classroom\":\"东上院202\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":1,\"end_sec\":2,\"week\":5,\"odd_or_even\":\"b\"}]},{\"classname\":\"2018-2019-1-MA080-394402\",\"course_id\":\"MA080\",\"teacher_id\":\"03156\",\"teacher_name\":\"王健\",\"teachers\":\"03156/王健/副教授[数学科学学院]\",\"course_participants\":120,\"class_note\":\"\",\"year\":2018,\"semester\":1,\"classSegments\":[{\"class_sec_id\":31160,\"classname\":\"2018-2019-1-MA080-394402\",\"classroom\":\"下院114\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":3,\"end_sec\":4,\"week\":1,\"odd_or_even\":\"b\"},{\"class_sec_id\":31161,\"classname\":\"2018-2019-1-MA080-394402\",\"classroom\":\"下院114\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":3,\"end_sec\":4,\"week\":3,\"odd_or_even\":\"b\"},{\"class_sec_id\":31162,\"classname\":\"2018-2019-1-MA080-394402\",\"classroom\":\"下院114\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":1,\"end_sec\":2,\"week\":5,\"odd_or_even\":\"b\"}]},{\"classname\":\"2018-2019-1-MA080-394403\",\"course_id\":\"MA080\",\"teacher_id\":\"03156\",\"teacher_name\":\"王健\",\"teachers\":\"03156/王健/副教授[数学科学学院]\",\"course_participants\":114,\"class_note\":\"\",\"year\":2018,\"semester\":1,\"classSegments\":[{\"class_sec_id\":31163,\"classname\":\"2018-2019-1-MA080-394403\",\"classroom\":\"上院515\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":1,\"end_sec\":2,\"week\":1,\"odd_or_even\":\"b\"},{\"class_sec_id\":31164,\"classname\":\"2018-2019-1-MA080-394403\",\"classroom\":\"上院515\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":1,\"end_sec\":2,\"week\":3,\"odd_or_even\":\"b\"},{\"class_sec_id\":31165,\"classname\":\"2018-2019-1-MA080-394403\",\"classroom\":\"上院515\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":3,\"end_sec\":4,\"week\":5,\"odd_or_even\":\"b\"}]},{\"classname\":\"2018-2019-1-MA080-394404\",\"course_id\":\"MA080\",\"teacher_id\":\"10743\",\"teacher_name\":\"徐永忠\",\"teachers\":\"10743/徐永忠/副教授[数学科学学院]\",\"course_participants\":78,\"class_note\":\"\",\"year\":2018,\"semester\":1,\"classSegments\":[{\"class_sec_id\":31166,\"classname\":\"2018-2019-1-MA080-394404\",\"classroom\":\"东中院4-501\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":1,\"end_sec\":2,\"week\":1,\"odd_or_even\":\"b\"},{\"class_sec_id\":31167,\"classname\":\"2018-2019-1-MA080-394404\",\"classroom\":\"东中院4-501\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":1,\"end_sec\":2,\"week\":3,\"odd_or_even\":\"b\"},{\"class_sec_id\":31168,\"classname\":\"2018-2019-1-MA080-394404\",\"classroom\":\"东中院4-501\",\"begin_week\":1,\"end_week\":16,\"begin_sec\":3,\"end_sec\":4,\"week\":5,\"odd_or_even\":\"b\"}]},{\"classname\":\"2018-2019-2-MA080-398005\",\"course_id\":\"MA080\",\"teacher_id\":\"03119\",\"teacher_name\":\"向光辉\",\"teachers\":\"03119/向光辉/副教授[数学科学学院]\",\"course_participants\":106,\"class_note\":\"重修班，仅供不及格同学修读(留学生、内地班,预科班特招生不可以选)\",\"year\":2018,\"semester\":2,\"classSegments\":[{\"class_sec_id\":31158,\"classname\":\"2018-2019-2-MA080-398005\",\"classroom\":\"下院114\",\"begin_week\":2,\"end_week\":17,\"begin_sec\":11,\"end_sec\":13,\"week\":2,\"odd_or_even\":\"b\"},{\"class_sec_id\":31159,\"classname\":\"2018-2019-2-MA080-398005\",\"classroom\":\"下院114\",\"begin_week\":2,\"end_week\":17,\"begin_sec\":11,\"end_sec\":13,\"week\":4,\"odd_or_even\":\"b\"}]}]}")

const initialState = {
  user_info: {
    id: "30673CFC-4D4C-4FC1-9FE4-000B3D9DAA9A",
  },
  sortlist:[
    course_info
  ],
  course_list: null,
  login_ready:false,
}
const store = createStore(combinedReducer,initialState)

configure({adapter: new Adapter()})

jest.mock("../src/utils/DataRequest.js")
jest.mock("../src/utils/LocalStorage.js")

test('renders CommentAbstract component correctly', (done) => {
  const tree = renderer.create(
      <CourseDetail store = {store} course = {course_info}  />
  ).toJSON();
  setTimeout(()=>{
    expect(tree).toMatchSnapshot();
    done();
  },1000)
});

describe("<CourseDetail /> component",()=>{
  const wrapper = shallow(
    <CourseDetail store = {store}  course = {course_info}  />
  );
  const instance = wrapper.dive().dive().instance();
  it("can switch detail state",(done)=>{
    instance.switchClassesDetailState();
    setTimeout(()=>{done();},100) /*wait for async to end*/
  })
  it("collect course into sortlist",(done)=>{
    instance.onCollect()
    setTimeout(()=>{done();},100) /*wait for async to end*/
  })
  it("render correctly when detail visible",(done)=>{/* not working*/
    setTimeout(()=>{done();},100) /*wait for async to end*/
  })
})

describe("<CourseDetail /> component not collected",()=>{
  const wrapper = shallow(
    <CourseDetail store = {store}  course = {course_info1}  />
  );
  const instance = wrapper.dive().dive().instance();
  it("collect course out of sortlist",(done)=>{
    instance.onCollect()
    setTimeout(()=>{done();},100) /*wait for async to end*/
  })
})
describe("<CourseDetail /> mount",()=>{/*todo : not working*/
  const wrapper = shallow(<CourseDetail store = {store}  course = {course_info2}/>).dive().dive()
  const instance = wrapper.instance()
  it("render details when set state",(done)=> {
    expect(instance.state.classesDetailVisible).toBe(false)
    instance.switchClassesDetailState()
    expect(instance.state.classesDetailVisible).toBe(true)
    instance._renderItem({item:course_info.classes[0]})
    instance._keyExtractor(12,123)
    setTimeout(()=>{done();},1000) /*wait for async to end*/
  })
  let class_info = course_info.classes[0];
  const tree = renderer.create(
    <ClassItem
      class_info = {class_info}
  />)
  class_info.class_note = "12345"
  const tree1 = renderer.create(
    <ClassItem
      class_info = {class_info}
    />)
  let course1 = Object.assign({},course_info)
  course1.classes = null;
  it("call onCollect correctly when course.classes is null",(done)=>{
    wrapper.setProps({
      course:course1
    })
    instance.render();
    setTimeout(()=>{done();},100) /*wait for async to end*/
  })
  it("render correctly when one teacher teach multiple cleass",()=>{
    const tree = renderer.create(
      <CourseDetail course={course_info3} store = {store} />
      )
  })
})


